# Локально-стабильные предикаты

Такой предикат, что как только становится истинным, его состояние не меняется, при этом зависит от какого-то набора процессов (как дедлок, например)\

## Интервал

#def Пара срезов $F, G \subset E$ называется **интервалом**, если $F \subset G$
* Пишем $[F, G]$

#def Интервал называется **согласованным**, если
$$\forall e \in E, f \in F: e \rightarrow f \Rightarrow e \in G$$

Оно же:
$$\nexists e \in E\backslash G, f \in F: e \rightarrow f$$

Примечание:
$E \backslash G$ это события справа от интервала $[F, G]$

### Теорема

Интервал $[F, G]$ согласован <=> внутри него есть согласованный срез $H$ между $F$ и $G$:
$$F \subset H \subset G$$

## Барьерная синхронизация

#def Интервал $[F, G]$ **барьерно синхронизирован**, если
$$\forall f \in F, g \in E \backslash G: f \rightarrow g$$

### Теорема
* Любой барьерно-синхронизированный интервал согласован

### Построение (варианты)
* Через координатора
	* Координатор собирает сообщения ото всех, затем рассылает всем
	* Срезы до и после сбора образуют _барьерно согласованный интервал_
* Посылка все-всем
* Посылка токена по кругу дважды
	* Первый прогон — первый срез, второй прогон — второй срез

## Алгоритм поиска дедлоков

Можно искать [[deadlock|дедлоки]] в системе

Инициатор собирает согласованный интервал из информации
* Кого данный процесс ждёт
* Менялся ли он между началом и концом интервала

Так, отсмотрев ожидания процессов, которые не изменяли состояния, можно найти дедлок