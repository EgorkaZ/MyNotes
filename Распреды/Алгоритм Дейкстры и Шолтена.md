# Алгоритм Дейкстры и Шолтена

Помогает решить проблему останова для [[Диффундирующие вычисления|диффундирующих вычислений]]

* Процессы выстраиваем в дерево
	* Красим их в _зелёный_ и _красный_
	* В самом начале все _красные_, кроме корня
* Требуем ack на сообщения
	* Считаем баланс (`balance`) посланных сообщений и ack'ов
* Каждый процесс знает своего родителя
* _Зелёный_, если:
	* Пассивен
	* нет детей в дереве `childCount`
	* `balance == 0`
* _Крассный_
	* Иначе
* _Зелёный_ -> _красный_
	* Происходит при получении сообщения
	* `parentId = sourceId`
	* Отправляем "ты мой родитель" на _source_
	* _source_ делает `childCount++`
* _Красный_ -> _зелёный_
	* При условии `balance == 0 && childCount == 0`
	* Отправляет "ты мне не отец" на _parent_
	* _parent_ делает `childCount--`
* Завершаем, если инициатор стал _зелёным_

Из этого проблема останова решается тривиально