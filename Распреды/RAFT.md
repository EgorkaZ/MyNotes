# RAFT

Алгоритм [[Консенсус|консенсуса]]

Решает задачу по поддержанию [[RSM]]
* Safety (correctness)
	* Никогда нет расхождений в состояниях стейт машины
* Availability
	* Сервера живые, пока не тормозят
* Asynchronous
* Fast (in normal case, cannot be slowed by a single server)


### Модель
![[Pasted image 20220404171256.png]]
1. Клиент общается с сервером
2. Консенсус модуль делает запись в лог (он должен сходиться на всех репликах)
3. Из лога формируется состояние
	* Здесь состояние - key-value storage, такое часто
4. Клиенту шлётся ответ

### Дизайн

Хочется полностью законченный жизненный протокол, а не эти ваши [[Paxos]]

* Акцент дизайна на **понятности**
	* Минимум состояний
	* Минимум недетерминизма (говорят, от него вся сложность)
* Три подзадачи:
	1. [[RAFT Leader Election|Leader Election]]
	2. [[RAFT Log Replication|Log Replication]]
	3. Safety
* Гарантии
	* Election Safety
		* Не более одного лидера
	* Leader Append-Only
		* Лидер только добавляет, но не перезаписывает журнал
	* Log Matching
		* Все записи в журнал совпадают
	* Leader Completes
		* committed записи будут у будущих лидеров
	* State Machine Safety
		* Однозначный выбор операции