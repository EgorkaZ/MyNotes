# Protected mode

Пришёл i80286

* новый способ адресации памяти: _кольца доступа_
	* 0 - ОСь - можно всё
	* 1, 2 - кем-то юзается, но кому вообще нужны, есть только 2 гендера
	* 3 - user-space
* сегменты всё ещё 16-тибитные
* существует глобальная табличка дескрипторов - GDT, где лежат описания сегментов
* указатель на неё лежит в  регистре`GDTR`
* ```
   struct Segment
   {
	   u16 idx: 13; // индекс в GDT
	   bool global_or_local: 1;
	   u8 RPL: 2;
   };
* предполагалась глобальная/локальная таблица дескрипторов
* дескриптор хранит (в т.ч.) базу и лимит
* права кода определяются полем `RPL` регистра `CS`
* `CS` меняется при jump'ах, при этом `RPL` не может понижаться (то есть, права могут понижаться)
* права можно повысить через прерывание
* также они повышаются при `syscall`'ах и всём таком

Можно уйти в [[Real mode]] через `CR0.PE = 0` (PE - protected enabled), вернуться - через `CR0.PE = 1`

